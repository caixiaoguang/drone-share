(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66e93389"],{"08a8":function(t,e,i){"use strict";var a=i("1313"),r=i.n(a);r.a},1313:function(t,e,i){},"14e4":function(t,e,i){"use strict";var a=i("972b"),r=i.n(a);r.a},3931:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map-container"},[i("l-map",{attrs:{zoom:t.zoom,"max-zoom":32,center:t.center,options:t.options},on:{ready:t.mapReady}},[t._t("default"),t._v(" "),i("l-control-layers",{attrs:{collapsed:!0,"sort-layers":!0},on:{ready:t.layerControlReady}}),t._v(" "),i("l-feature-group",{attrs:{"layer-type":"base",name:"天地图"}},t._l(t.tianditu,(function(t){return i("l-tile-layer",{key:t.name,attrs:{url:t.url,visible:t.visible}})})),1),t._v(" "),i("l-tile-layer",{attrs:{name:"影像图","layer-type":"base",visible:!1,url:t.satellite.url}})],2)],1)},r=[],n=i("2699"),o=i("9ee8"),s=i("a40a"),l=i("c5ca"),p=i("044a"),c=i("2b0e"),u={props:{isMain:{type:Boolean,default:!1}},components:{LMap:n["a"],LControlLayers:o["a"],LTileLayer:s["a"],LFeatureGroup:l["a"],LGeoJson:p["a"]},data:function(){return{zoom:9,center:[26.51,106.62],options:{attributionControl:!1,preferCanvas:!0},tianditu:[{name:"tianditu",visible:!0,url:"https://t0.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=1902c209c7a7480dfb962751b839b91e"},{name:"tianditu_label",visible:!0,url:"https://t0.tianditu.gov.cn/cva_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=1902c209c7a7480dfb962751b839b91e"}],satellite:{name:"satellite",url:"https://t2.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=1902c209c7a7480dfb962751b839b91e"}}},methods:{mapReady:function(t){this.isMain&&(c["default"].prototype.$map=t),this.$emit("mapReady",t)},layerControlReady:function(t){this.isMain&&(c["default"].prototype.$layerControl=t)}}},f=u,d=(i("14e4"),i("2877")),v=Object(d["a"])(f,a,r,!1,null,"601753f7",null);e["a"]=v.exports},"457d":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("common-filter",{attrs:{filterType:"airspace"}})},r=[],n=i("db72"),o=i("2f62"),s=i("af31"),l={name:"Dashboard",components:{CommonFilter:s["a"]},data:function(){return{}},computed:Object(n["a"])({},Object(o["b"])(["userInfo"])),methods:{}},p=l,c=(i("08a8"),i("2877")),u=Object(c["a"])(p,a,r,!1,null,null,null);e["default"]=u.exports},"972b":function(t,e,i){},"9b86":function(t,e,i){"use strict";var a=i("da7c"),r=i.n(a);r.a},af31:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dashboard-container"},[i("main-map",{staticClass:"map-com",on:{mapReady:t.mapReady}},[void 0],2),t._v(" "),i("div",{staticClass:"info-list"},[t._m(0),t._v(" "),i("el-form",{attrs:{size:"mini","label-position":"right"}},[i("el-form-item",{staticClass:"mb10"},[i("el-radio-group",{on:{change:t.queryInfo},model:{value:t.infoType,callback:function(e){t.infoType=e},expression:"infoType"}},[i("el-radio-button",{attrs:{label:"supplyInfo"}},[i("svg-icon",{attrs:{"icon-class":"供应"}}),t._v("供应信息\n          ")],1),t._v(" "),i("el-radio-button",{attrs:{label:"demandInfo"}},[i("svg-icon",{attrs:{"icon-class":"需求"}}),t._v("需求信息\n          ")],1)],1)],1),t._v(" "),t._l(t.filterOption,(function(e){return i("el-form-item",{key:e.prop,attrs:{label:e.label,"label-width":"85px"}},[i("el-select",{attrs:{clearable:""},model:{value:t.form[t.filterType][e.prop],callback:function(i){t.$set(t.form[t.filterType],e.prop,i)},expression:"form[filterType][option.prop]"}},t._l(e.content.options,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)})),t._v(" "),i("district-select",{attrs:{labelWidth:"85px"},model:{value:t.administrativDivision,callback:function(e){t.administrativDivision=e},expression:"administrativDivision"}}),t._v(" "),i("div",{staticClass:"filter-btn"},[i("el-button",{attrs:{type:"primary",size:"small",icon:t.isLoading?"el-icon-loading":""},on:{click:t.queryInfo}},[t._v("查询")])],1)],2),t._v(" "),i("div",{staticClass:"result-list"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],attrs:{data:t.relustList,size:"mini",height:"100%"},on:{"row-click":t.rowClick}},[t.isSupplyDroneOrDriver?t._e():i("el-table-column",{attrs:{prop:"name",label:"名称"}}),t._v(" "),i("el-table-column",{attrs:{label:"位置"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row["province"]+e.row["city"]||""+e.row["district"]||""))]}}])}),t._v(" "),t._l(t.filterFields,(function(e){return i("el-table-column",{key:e.prop,attrs:{label:e.label,width:"area"==e.prop?"45px":""},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v(t._s(i.row[e.prop]))]}}],null,!0)})})),t._v(" "),i("el-table-column",{attrs:{label:"发布人"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row["companyName"]||e.row["username"]))]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"联系方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.token?i("span",[t._v(t._s(e.row["contact"]))]):i("span",[t._v("登陆后查看")])]}}])})],2)],1),t._v(" "),i("el-pagination",{attrs:{background:"",layout:"prev, pager, next, sizes,total","page-size":t.pageSize,"page-sizes":[10,15,20,30],"current-page":t.page,total:t.total,size:"mini"},on:{"size-change":t.queryInfo,"current-change":t.queryInfo}})],1)],1)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"title"},[i("i",{staticClass:"el-icon-tickets"}),t._v(" 供需信息列表\n    ")])}],n=(i("7f7f"),i("ac6a"),i("db72")),o=i("3620"),s=i("274e"),l=i("c24f"),p=i("3931"),c=i("044a"),u=i("2f62"),f=o["c"].slice(1,o["c"].length),d=o["b"].slice(1,o["b"].length),v={drones:f,drivers:d,airspace:[],aerialData:[o["d"][0],{prop:"area",label:"面积"},{prop:"date",label:"拍摄日期"},{prop:"resolution",label:"分辨率"},{prop:"precision",label:"精度"}]},y={props:{filterType:String},components:{DistrictSelect:s["a"],MainMap:p["a"],LGeoJson:c["a"]},data:function(){return{infoType:"supplyInfo",isLoading:!1,form:{aerialData:{aerialDataType:"正射影像"},businessFields:"应急",drones:{droneType:"多旋翼",droneUsage:"地理测绘"},drivers:{driverLicenceSource:"AOPA",driverType:"多旋翼",grade:"一",driverGrade:"视距内等级"}},administrativDivision:"",page:1,pageSize:10,total:0,relustList:[]}},created:function(){this.queryInfo()},computed:Object(n["a"])({},Object(u["b"])(["token"]),{isSupplyDroneOrDriver:function(){var t="supplyInfo"==this.infoType;return t&&"drones"==this.filterType||t&&"drivers"==this.filterType},filterOption:function(){var t=this;return"aerialData"==this.filterType?o["d"].filter((function(t){return"aerialDataType"==t.prop})):"businessFields"==this.filterType?o["d"].filter((function(e){return e.prop==t.filterType})):"drones"==this.filterType?o["c"].filter((function(t){return"droneMaker"!=t.prop&&"buyTime"!=t.prop&&"isSale"!=t.prop&&"maxLoad"!=t.prop&&"index"!=t.type})):"drivers"==this.filterType?o["b"].filter((function(t){return"index"!=t.type})):void 0},filterFields:function(){return"drones"==this.filterType&&"demandInfo"==this.infoType?v[this.filterType].filter((function(t){return"buyTime"!=t.prop&&"droneMaker"!=t.prop&&"maxLoad"!=t.prop})):v[this.filterType]},airspaceGeoList:function(){if("airspace"==this.filterType&&"supplyInfo"==this.infoType)return this.relustList.filter((function(t){return Boolean(t.region)}))}}),methods:{queryInfo:function(){var t=this;this.isLoading=!0,delete this.administrativDivision.centerLat,delete this.administrativDivision.centerLon,this.isSupplyDroneOrDriver?this.getCompanyList():Object(l["a"])(this.page,this.pageSize,Object(n["a"])({},this.form[this.filterType],{},this.administrativDivision,{type:this.infoType,releaseType:this.filterType})).then((function(e){t.formatData(e.datas)}))},getCompanyList:function(){var t=this;Object(l["b"])(this.page,this.pageSize,Object(n["a"])({},this.form[this.filterType],{},this.administrativDivision)).then((function(e){var i=e.datas;i.datas.forEach((function(e){for(var i in e[t.filterType][0])e[i]=e[t.filterType][0][i]})),t.isLoading=!1,t.relustList=i.datas,t.addGeo(),t.total=i.total}))},formatData:function(t){var e=this;this.isLoading=!1,"drones"!=this.filterType&&"drivers"!=this.filterType||t.datas.forEach((function(t){for(var i in t[e.filterType][0])t[i]=t[e.filterType][0][i]})),t.datas.forEach((function(t){for(var e in t["userInfo"])t[e]=t["userInfo"][e]})),this.relustList=t.datas,this.addGeo(),this.total=t.total},rowClick:function(t){t.region&&this.$map.fitBounds(t.$bounds)},addGeo:function(){var t=this;this.$featureGroup?this.$featureGroup.clearLayers():(this.$featureGroup=L.featureGroup(),this.$featureGroup.addTo(this.$map)),this.relustList.forEach((function(e){if(e.region){var i=L.geoJSON(JSON.parse(e.region)).bindTooltip(e.name);e.$bounds=i.getBounds(),t.$featureGroup.addLayer(i)}}))},mapReady:function(t){this.$map=t}}},m=y,b=(i("9b86"),i("2877")),h=Object(b["a"])(m,a,r,!1,null,"4ee3ed80",null);e["a"]=h.exports},da7c:function(t,e,i){}}]);